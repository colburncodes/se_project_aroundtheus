!function(){"use strict";function e(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r=class{constructor(e,r){t(this,"_showInputError",(e=>{const t=document.querySelector(`.${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass),e.classList.add(this._settings.inputErrorClass)})),t(this,"_hideInputError",(e=>{const t=document.querySelector(`.${e.id}-error`);t.textContent="",e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass)})),t(this,"_checkInputValidity",((e,t)=>{e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)})),t(this,"_checkFormValidity",(()=>[...this._formElement.querySelectorAll(this._settings.inputSelector)].every((e=>e.validity.valid)))),t(this,"_toggleButtonState",(()=>{this._checkFormValidity()?(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.removeAttribute("disabled")):(this._buttonElement.setAttribute("disabled","true"),this._buttonElement.classList.add(this._settings.inactiveButtonClass))})),this._formElement=e,this._settings=r,this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSeletor)}enableValidation(){Array.from(document.querySelectorAll(this._settings.formSelector)).forEach((e=>{e.addEventListener("submit",(function(e){e.preventDefault()}));const t=[...e.querySelectorAll(this._settings.inputSelector)];this._toggleButtonState(),e.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}),0)})),t.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e,this._settings),this._toggleButtonState()}))}))}))}};function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n=class{constructor(e){s(this,"_handleCloseButton",(()=>{this.closeModal()})),s(this,"_handleEscapePopup",(e=>{"Escape"===e.key&&this.closeModal()})),s(this,"_handleModalOverlay",(e=>{e.target.classList.contains(".modal")&&this.closeModal()})),this._popupElement=document.querySelector(`${e}`)}openModal(){this._popupElement.classList.add("modal__open"),document.addEventListener("keyup",this._handleEscapePopup)}closeModal(){this._popupElement.classList.remove("modal__open"),document.removeEventListener("keyup",this._handleEscapePopup)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal__open")&&this.closeModal(),e.target.classList.contains("modal__close")&&this.closeModal()}))}},i=class extends n{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super(t),this._modalForm=this._popupElement.querySelector(".modal__form"),this._inputs=this._modalForm.querySelectorAll(".modal__input"),this._handleFormSubmit=r,this._buttonElement=this._modalForm.querySelector(".modal__save-button")}_getInputValues(){const e={};return this._inputs.forEach((t=>e[t.name]=t.value)),e}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}closeModal(){this._modalForm.reset(),super.closeModal()}};const o="db0cb0b5-b0ef-4843-a8af-9c3db60e50cb",a={authorization:o,"Content-Type":"application/json"},l={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSeletor:".modal__save-button",inactiveButtonClass:"modal__button-disabled",inputErrorClass:"modal__input-error",errorClass:"modal__error_visible"},d=document.querySelector(".modal__form-create"),c=document.querySelector(".profile__add-button"),u=document.querySelector(".profile__avatar-edit"),h=document.querySelector(".profile__edit-button"),m=document.querySelector(".modal__input-profile-name"),_=document.querySelector(".modal__input-profile-description"),p=(document.querySelector(".card__like-button"),new class{constructor(t){let{baseUrl:r,authToken:s,headers:n}=t;e(this,"getInitialCards",(async()=>{const e=await fetch(`${this._baseUrl}/cards`,{headers:this._headers});return this._handleResponse(e)})),e(this,"addCard",(async e=>{let{name:t,link:r}=e;const s=await fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})});return this._handleResponse(s)})),e(this,"deleteCardById",(async e=>{const t=await fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers,body:JSON.stringify({id:e})});return this._handleResponse(t)})),e(this,"getUserInfo",(async()=>{const e=await fetch(`${this._baseUrl}/users/me`,{headers:this._headers});return this._handleResponse(e)})),e(this,"editUserInfo",(async e=>{let{name:t,about:r}=e;const s=await fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})});return this._handleResponse(s)})),e(this,"setUserAvatar",(async e=>{let{avatar:t}=e;const r=await fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})});return this._handleResponse(r)})),e(this,"changeCardLikeStatus",(async(e,t)=>{const r=await fetch(`${this._baseUrl}/cards/likes/${e}`,{method:t?"PUT":"DELETE",headers:this._headers,body:JSON.stringify({like:t})});return this._handleResponse(r)})),this._baseUrl=r,this._authToken=s,this._headers=n}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} ${e.statusText}`)}_handleResponseError(e){console.log(`Error processing request ${e}`)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",authToken:o,headers:a})),v=document.querySelector("#modal__edit"),g=document.querySelector("#modal__create"),b=document.querySelector("#avatar-modal"),y=new class extends n{open(e){let{name:t,link:r}=e;this._imageElement=document.querySelector("#image-modal"),super.setEventListeners();const s=this._imageElement.querySelector(".modal__preview-image"),n=this._imageElement.querySelector(".modal__caption");s.src=r,s.alt=t,n.textContent=t,super.openModal()}}("#image-modal"),f=new class extends n{constructor(e){super(e),this._modalElement=document.querySelector(e),this._submitButton=this._modalElement.querySelector(".modal__save-button")}renderLoading(e){this._submitButton.textContent=e?"Deleting...":"Yes"}setSubmitAction(e){this._submitButton.addEventListener("click",e)}setEventListeners(){super.setEventListeners()}}("#delete-modal"),E=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(t),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,role:this._descriptionElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,about:r}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=r}setAvatar(e){this._avatarElement.src=e}}(".profile__title",".profile__description",".profile__image"),S=new r(v,l),L=new r(g,l),k=new r(b,l);let C;function I(e,t){const r=new class{constructor(e,t){let{data:r,userId:s,handleImageClick:n,handleDeleteClick:i,handleUserLikes:o}=e;var a,l,d;a=this,d=()=>this._id,(l=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(l="getCardId"))in a?Object.defineProperty(a,l,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[l]=d,this._data=r,this._id=r._id,this._userId=s,this._ownerId=r.owner._id,this._name=r.name,this._link=r.link,this._likes=r.likes,this._cardSelector=t,this._handleImageClick=n,this._handleDeleteClick=i,this._handleUserLikes=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}handleDeleteCard(){this._element.remove(),this._element=null}setLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this.imageCountElement.textContent=this._likes.length||"",this.isLiked()?this.imageLikeElement.classList.add("card__like-active"):this.imageLikeElement.classList.remove("card__like-active")}_setEventListeners(){this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteClick())),this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleUserLikes())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handleImageClick({name:this._name,src:this._link})))}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this.imageElement=this._element.querySelector(".card__image"),this.imageElementText=this._element.querySelector(".card__label-text"),this.imageDeleteElement=this._element.querySelector(".card__delete-button"),this.imageLikeElement=this._element.querySelector(".card__like-button"),this.imageCountElement=this._element.querySelector(".card__like-count"),this.imageElement.src=this._link,this.imageElement.alt=this._name,this.imageElementText.textContent=this._name,this._renderLikes(),this._userId!==this._ownerId&&this.imageDeleteElement.remove(),this._element}}({data:e,userId:t,handleImageClick:()=>{y.open(e)},handleDeleteClick:()=>{const e=r.getCardId();f.openModal(),f.setSubmitAction((()=>{f.renderLoading(!0),p.deleteCardById(e).then((()=>{r.handleDeleteCard(),f.closeModal()})).catch((e=>console.error(e))).finally((()=>f.renderLoading(!1)))}))},handleUserLikes:()=>{p.changeCardLikeStatus(r.getCardId(),!r.isLiked()).then((e=>{r.setLikes(e.likes)})).catch((e=>console.error(e)))}},"#card-template");return r.generateCard()}c.addEventListener("click",(()=>{q.openModal()}));const q=new i({popupSelector:"#modal__create",handleFormSubmit:e=>{q.renderLoading(!0),p.addCard(e).then((e=>{const t=I(e,e.owner._id);C.addItem(t),d.reset(),q.closeModal()})).catch((e=>{console.error(e)})).finally((()=>q.renderLoading(!1)))}});u.addEventListener("click",(()=>{w.openModal()}));const w=new i({popupSelector:"#avatar-modal",handleFormSubmit:e=>{w.renderLoading(!0),p.setUserAvatar(e).then((e=>{E.setAvatar(e),w.closeModal()})).catch((e=>console.log(e))).finally((()=>w.renderLoading(!1)))}});h.addEventListener("click",(()=>{const{name:e,role:t}=E.getUserInfo();(e=>{let{name:t,role:r}=e;m.value=t,_.value=r})({name:e,role:t}),U.openModal()}));const U=new i({popupSelector:"#modal__edit",handleFormSubmit:e=>{U.renderLoading(!0),p.editUserInfo(e).then((e=>{E.setUserInfo({name:e.name,about:e.about,avatar:e.avatar}),U.closeModal()})).catch((e=>{console.error(e)})).finally((()=>U.renderLoading(!1)))}});p.getAppInfo().then((e=>{let[t,r]=e;E.setUserInfo({name:t.name,about:t.about});const s=t.avatar;E.setAvatar(s);const n=t._id;C=new class{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}({items:r,renderer:e=>{const t=I(e,n);C.addItem(t)}},".cards__list"),C.renderItems()})).catch((e=>{console.error(e)})),q.setEventListeners(),w.setEventListeners(),f.setEventListeners(),U.setEventListeners(),y.setEventListeners(),k.enableValidation(),L.enableValidation(),S.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxFQUMxQixHTmlLSSxDQUNFTixNQUFPRixFQUNQRyxTQUFXekQsSUFDVCxNQUFNRSxFQUFPSCxFQUFXQyxFQUFNQyxHQUM5QkgsRUFBVWlELFFBQVE3QyxFQUFLLEdEaEtqQixnQkNxS1pKLEVBQVUrRCxhQUFhLElBRXhCckIsT0FBTzlFLElBQ05DLFFBQVE4RSxNQUFNL0UsRUFBSSxJQUd0QmtGLEVBQWFySSxvQkFDYnlJLEVBQWdCekksb0JBQ2hCb0UsRUFBa0JwRSxvQkFDbEI0SSxFQUFjNUksb0JBQ2Q2RCxFQUFXN0Qsb0JBRVhzRixFQUFvQjNHLG1CQUNwQjBHLEVBQW9CMUcsbUJBQ3BCd0csRUFBa0J4RyxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoZm9ybUVsZW1lbnQsIHNldHRpbmdzKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZXRvclxuICAgICk7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dCwgc2V0dGluZ3MpID0+IHtcbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0LCBzZXR0aW5ncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0LCBzZXR0aW5ncyk7XG4gICAgfVxuICB9O1xuXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSA9ICgpID0+IHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBbXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxuICAgIF07XG5cbiAgICByZXR1cm4gaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dCkgPT4gaW5wdXQudmFsaWRpdHkudmFsaWQpO1xuICB9O1xuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSA9ICgpID0+IHtcbiAgICBjb25zdCBpc1ZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcblxuICAgIGlmIChpc1ZhbGlkKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB9XG4gIH07XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmZvcm1TZWxlY3RvcilcbiAgICApO1xuXG4gICAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaW5wdXRzID0gW1xuICAgICAgICAuLi5mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxuICAgICAgXTtcblxuICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgIH0sIDApOyAvLyBpdOKAmXMgZW5vdWdoIHRvIHB1dCAwIG1zIGhlcmVcbiAgICAgIH0pO1xuXG4gICAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQsIHRoaXMuX3NldHRpbmdzKTtcbiAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke3BvcHVwU2VsZWN0b3J9YCk7XG4gIH1cblxuICBvcGVuTW9kYWwoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fb3BlblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjYXBlUG9wdXApO1xuICB9XG5cbiAgY2xvc2VNb2RhbCgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19vcGVuXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NhcGVQb3B1cCk7XG4gIH1cblxuICBfaGFuZGxlQ2xvc2VCdXR0b24gPSAoKSA9PiB7XG4gICAgdGhpcy5jbG9zZU1vZGFsKCk7XG4gIH07XG5cbiAgX2hhbmRsZUVzY2FwZVBvcHVwID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICB9XG4gIH07XG5cbiAgX2hhbmRsZU1vZGFsT3ZlcmxheSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCIubW9kYWxcIikpIHtcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fb3BlblwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICAgIH1cbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKSkge1xuICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX2lucHV0cyA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IChmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUpKTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNsb3NlTW9kYWwoKSB7XG4gICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2VNb2RhbCgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCJleHBvcnQgY29uc3QgQkFTRV9VUkwgPSBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIjtcbmV4cG9ydCBjb25zdCBBVVRIX1RPS0VOID0gXCJkYjBjYjBiNS1iMGVmLTQ4NDMtYThhZi05YzNkYjYwZTUwY2JcIjtcbmV4cG9ydCBjb25zdCBIRUFERVJTID0ge1xuICBhdXRob3JpemF0aW9uOiBBVVRIX1RPS0VOLFxuICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbn07XG5cbi8vIHZhbGlkYXRpb24gYWN0aXZhdGlvblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRGb3JtQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxldG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uLWRpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgY2FyZHNTZWN0aW9uOiBcIi5jYXJkc19fbGlzdFwiLFxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgYWRkTW9kYWw6IFwiI21vZGFsX19jcmVhdGVcIixcbiAgZWRpdE1vZGFsOiBcIiNtb2RhbF9fZWRpdFwiLFxuICBhdmF0YXJNb2RhbDogXCIjYXZhdGFyLW1vZGFsXCIsXG4gIGltYWdlTW9kYWw6IFwiI21vZGFsLWltYWdlXCIsXG4gIGRlbGV0ZU1vZGFsOiBcIiNkZWxldGUtbW9kYWxcIixcbiAgY2FyZE1vZGFsRm9ybTogXCIubW9kYWxfX2Zvcm0tY3JlYXRlXCIsXG4gIHByb2ZpbGVNb2RhbEZvcm06IFwiLm1vZGFsX19mb3JtLWVkaXRcIixcbiAgbW9kYWxTZWxlY3RvcjogXCIubW9kYWxcIixcbiAgcHJvZmlsZUltYWdlOiBcIi5wcm9maWxlX19pbWFnZVwiLFxuICBwcm9maWxlVGl0bGU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVNb2RhbEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtLWNyZWF0ZVwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0XCIpO1xuZXhwb3J0IGNvbnN0IGVkaXRVc2VyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlSW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0LXByb2ZpbGUtbmFtZVwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVJbnB1dERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2lucHV0LXByb2ZpbGUtZGVzY3JpcHRpb25cIlxuKTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb25cIjtcblxuaW1wb3J0IHtcbiAgc2VsZWN0b3JzLFxuICBjcmVhdGVNb2RhbEZvcm0sXG4gIGFkZENhcmRCdXR0b24sXG4gIGVkaXRVc2VyQnV0dG9uLFxuICBhdmF0YXJJY29uLFxuICBwcm9maWxlSW5wdXROYW1lLFxuICBwcm9maWxlSW5wdXREZXNjcmlwdGlvbixcbiAgZGVmYXVsdEZvcm1Db25maWcsXG4gIEJBU0VfVVJMLFxuICBBVVRIX1RPS0VOLFxuICBIRUFERVJTLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBCQVNFX1VSTCxcbiAgYXV0aFRva2VuOiBBVVRIX1RPS0VOLFxuICBoZWFkZXJzOiBIRUFERVJTLFxufSk7XG5cbmNvbnN0IGVkaXRVc2VyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsX19lZGl0XCIpO1xuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fY3JlYXRlXCIpO1xuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XG5cbmNvbnN0IGNvbmZpcm1hdGlvblBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihzZWxlY3RvcnMuZGVsZXRlTW9kYWwpO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgc2VsZWN0b3JzLnByb2ZpbGVUaXRsZSxcbiAgc2VsZWN0b3JzLnByb2ZpbGVEZXNjcmlwdGlvbixcbiAgc2VsZWN0b3JzLnByb2ZpbGVJbWFnZVxuKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihlZGl0VXNlck1vZGFsLCBkZWZhdWx0Rm9ybUNvbmZpZyk7XG5jb25zdCBjcmVhdGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYWRkQ2FyZE1vZGFsLCBkZWZhdWx0Rm9ybUNvbmZpZyk7XG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYXZhdGFyTW9kYWwsIGRlZmF1bHRGb3JtQ29uZmlnKTtcblxubGV0IGNhcmRzTGlzdDtcblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhLCB1c2VySWQpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIHtcbiAgICAgIGRhdGE6IGRhdGEsXG4gICAgICB1c2VySWQ6IHVzZXJJZCxcbiAgICAgIGhhbmRsZUltYWdlQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgaW1hZ2VQb3B1cC5vcGVuKGRhdGEpO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZURlbGV0ZUNsaWNrOiAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gY2FyZC5nZXRDYXJkSWQoKTtcbiAgICAgICAgY29uZmlybWF0aW9uUG9wdXAub3Blbk1vZGFsKCk7XG4gICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgICAgICAgY29uZmlybWF0aW9uUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kZWxldGVDYXJkQnlJZChpZClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgICAgICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLmNsb3NlTW9kYWwoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4gY29uZmlybWF0aW9uUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSkpO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVVc2VyTGlrZXM6ICgpID0+IHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmNoYW5nZUNhcmRMaWtlU3RhdHVzKGNhcmQuZ2V0Q2FyZElkKCksICFjYXJkLmlzTGlrZWQoKSlcbiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzcG9uc2UubGlrZXMpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiXG4gICk7XG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufVxuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1Nb2RhbC5vcGVuTW9kYWwoKTtcbn0pO1xuXG5jb25zdCBhZGRGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5hZGRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBhZGRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKGRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhLCBkYXRhLm93bmVyLl9pZCk7XG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmQpO1xuICAgICAgICBjcmVhdGVNb2RhbEZvcm0ucmVzZXQoKTtcbiAgICAgICAgYWRkRm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4gYWRkRm9ybU1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcbiAgfSxcbn0pO1xuXG5hdmF0YXJJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckZvcm1Nb2RhbC5vcGVuTW9kYWwoKTtcbn0pO1xuXG5jb25zdCBhdmF0YXJGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5hdmF0YXJNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGF2YXRhcikgPT4ge1xuICAgIGF2YXRhckZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIGFwaVxuICAgICAgLnNldFVzZXJBdmF0YXIoYXZhdGFyKVxuICAgICAgLnRoZW4oKGF2YXRhcikgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRBdmF0YXIoYXZhdGFyKTtcbiAgICAgICAgYXZhdGFyRm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IGF2YXRhckZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XG4gIH0sXG59KTtcblxuY29uc3QgZmlsbFByb2ZpbGVGb3JtID0gKHsgbmFtZSwgcm9sZSB9KSA9PiB7XG4gIHByb2ZpbGVJbnB1dE5hbWUudmFsdWUgPSBuYW1lO1xuICBwcm9maWxlSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHJvbGU7XG59O1xuXG5lZGl0VXNlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIHJvbGUgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGZpbGxQcm9maWxlRm9ybSh7IG5hbWUsIHJvbGUgfSk7XG4gIGVkaXRGb3JtTW9kYWwub3Blbk1vZGFsKCk7XG59KTtcblxuY29uc3QgZWRpdEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmVkaXRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBlZGl0Rm9ybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZWRpdFVzZXJJbmZvKGRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXG4gICAgICAgIH0pO1xuICAgICAgICBlZGl0Rm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4gZWRpdEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XG4gIH0sXG59KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFt1c2VyLCBjYXJkc10pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICBhYm91dDogdXNlci5hYm91dCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGF2YXRhciA9IHVzZXIuYXZhdGFyO1xuICAgIHVzZXJJbmZvLnNldEF2YXRhcihhdmF0YXIpO1xuXG4gICAgY29uc3QgdXNlcklkID0gdXNlci5faWQ7XG4gICAgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSwgdXNlcklkKTtcbiAgICAgICAgICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBzZWxlY3RvcnMuY2FyZHNTZWN0aW9uXG4gICAgKTtcbiAgICBjYXJkc0xpc3QucmVuZGVySXRlbXMoKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG5hZGRGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmF2YXRhckZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuY29uZmlybWF0aW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jcmVhdGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhdXRoVG9rZW4sIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2F1dGhUb2tlbiA9IGF1dGhUb2tlbjtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVSZXNwb25zZShyZXNwb25zZSkge1xuICAgIHJldHVybiByZXNwb25zZS5va1xuICAgICAgPyByZXNwb25zZS5qc29uKClcbiAgICAgIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICB9XG5cbiAgX2hhbmRsZVJlc3BvbnNlRXJyb3IoZXJyKSB7XG4gICAgY29uc29sZS5sb2coYEVycm9yIHByb2Nlc3NpbmcgcmVxdWVzdCAke2Vycn1gKTtcbiAgfVxuXG4gIC8vIEdFVDogR2V0IEFwcCBEYXRhIChjYXJkc0xpc3QsIHVzZXJEYXRhKVxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XG4gIH1cblxuICAvLyBHRVQ6IExpc3Qgb2YgY2FyZHNcbiAgZ2V0SW5pdGlhbENhcmRzID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG5cbiAgLy8gUE9TVDogQWRkIG5ldyBjYXJkXG4gIGFkZENhcmQgPSBhc3luYyAoeyBuYW1lLCBsaW5rIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzcG9uc2UpO1xuICB9O1xuXG4gIC8vIERFTEVURTogRGVsZXRlIGNhcmRcbiAgZGVsZXRlQ2FyZEJ5SWQgPSBhc3luYyAoaWQpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaWQsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzcG9uc2UpO1xuICB9O1xuXG4gIC8vIEdFVDogR2V0cyBVc2VyIFByb2ZpbGVcbiAgZ2V0VXNlckluZm8gPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgfTtcblxuICAvLyBQQVRDSDogRWRpdCBVc2VyIFByb2ZpbGVcbiAgZWRpdFVzZXJJbmZvID0gYXN5bmMgKHsgbmFtZSwgYWJvdXQgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0LFxuICAgICAgfSksXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgfTtcblxuICAvLyBQQVRDSDogRWRpdCBQcm9maWxlIFBpY3R1cmVcbiAgc2V0VXNlckF2YXRhciA9IGFzeW5jICh7IGF2YXRhciB9KSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG5cbiAgLy8gUFVUIHwgREVMRVRFOiBBZGQgfCBSZW1vdmUgVXNlciBsaWtlc1xuICBjaGFuZ2VDYXJkTGlrZVN0YXR1cyA9IGFzeW5jIChjYXJkSWQsIGxpa2UpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogbGlrZSA/IFwiUFVUXCIgOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbGlrZSxcbiAgICAgIH0pLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3BXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLW1vZGFsXCIpO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9pbWFnZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkRGVzY3JpcHRpb24gPSB0aGlzLl9pbWFnZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuICAgIGNhcmRJbWFnZS5zcmMgPSBsaW5rO1xuICAgIGNhcmRJbWFnZS5hbHQgPSBuYW1lO1xuICAgIGNhcmREZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3Blbk1vZGFsKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wV2l0aEltYWdlO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIlxuICAgICk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJZZXNcIjtcbiAgICB9XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oaGFuZGxlU3VibWl0KSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVTdWJtaXQpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aENvbmZpcm1hdGlvbjtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgcm9sZTogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xuICB9XG5cbiAgc2V0QXZhdGFyKGF2YXRhcikge1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgZGF0YSwgdXNlcklkLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGVDbGljaywgaGFuZGxlVXNlckxpa2VzIH0sXG4gICAgY2FyZFNlbGVjdG9yXG4gICkge1xuICAgIHRoaXMuX2RhdGEgPSBkYXRhO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZVVzZXJMaWtlcyA9IGhhbmRsZVVzZXJMaWtlcztcbiAgfVxuXG4gIGdldENhcmRJZCA9ICgpID0+IHRoaXMuX2lkO1xuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZTtcbiAgfVxuXG4gIGhhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIHNldExpa2VzKGxpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICAvLyByZXR1cm4gdHJ1ZSBpZiB1c2VyIGxpa2VkIHRoZSBjYXJkLCBvdGhlcndpc2UgZmFsc2VcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgobGlrZSkgPT4gbGlrZS5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgdGhpcy5pbWFnZUNvdW50RWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aCB8fCBcIlwiO1xuXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICB0aGlzLmltYWdlTGlrZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmltYWdlTGlrZUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKCkpO1xuXG4gICAgdGhpcy5fZWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlVXNlckxpa2VzKCkpO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXG4gICAgICAgIHNyYzogdGhpcy5fbGluayxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuaW1hZ2VFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuaW1hZ2VFbGVtZW50VGV4dCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19sYWJlbC10ZXh0XCIpO1xuICAgIHRoaXMuaW1hZ2VEZWxldGVFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLmltYWdlTGlrZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5pbWFnZUNvdW50RWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50XCIpO1xuXG4gICAgdGhpcy5pbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLmltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuaW1hZ2VFbGVtZW50VGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuXG4gICAgaWYgKHRoaXMuX3VzZXJJZCAhPT0gdGhpcy5fb3duZXJJZCkge1xuICAgICAgdGhpcy5pbWFnZURlbGV0ZUVsZW1lbnQucmVtb3ZlKCk7XG4gICAgfSBcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iLCJjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJmb3JtRWxlbWVudCIsInNldHRpbmdzIiwiaW5wdXQiLCJlcnJvckVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0aGlzIiwiX3NldHRpbmdzIiwiZXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsInJlbW92ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJfZm9ybUVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsImV2ZXJ5IiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiX2J1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwicmVtb3ZlQXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwic3VibWl0QnV0dG9uU2VsZXRvciIsImVuYWJsZVZhbGlkYXRpb24iLCJBcnJheSIsImZyb20iLCJmb3JtU2VsZWN0b3IiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiaW5wdXRzIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwic2V0VGltZW91dCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJwb3B1cFNlbGVjdG9yIiwiY2xvc2VNb2RhbCIsImtleSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsIm9wZW5Nb2RhbCIsIl9oYW5kbGVFc2NhcGVQb3B1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX21vZGFsRm9ybSIsIl9pbnB1dHMiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJuYW1lIiwidmFsdWUiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwicmVzZXQiLCJBVVRIX1RPS0VOIiwiSEVBREVSUyIsImF1dGhvcml6YXRpb24iLCJkZWZhdWx0Rm9ybUNvbmZpZyIsImNyZWF0ZU1vZGFsRm9ybSIsImFkZENhcmRCdXR0b24iLCJhdmF0YXJJY29uIiwiZWRpdFVzZXJCdXR0b24iLCJwcm9maWxlSW5wdXROYW1lIiwicHJvZmlsZUlucHV0RGVzY3JpcHRpb24iLCJhcGkiLCJiYXNlVXJsIiwiYXV0aFRva2VuIiwiaGVhZGVycyIsImFzeW5jIiwicmVzcG9uc2UiLCJmZXRjaCIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJsaW5rIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImF2YXRhciIsImNhcmRJZCIsImxpa2UiLCJfYXV0aFRva2VuIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJfaGFuZGxlUmVzcG9uc2VFcnJvciIsImVyciIsImNvbnNvbGUiLCJsb2ciLCJnZXRBcHBJbmZvIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0VXNlck1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwiYXZhdGFyTW9kYWwiLCJpbWFnZVBvcHVwIiwib3BlbiIsIl9pbWFnZUVsZW1lbnQiLCJjYXJkSW1hZ2UiLCJjYXJkRGVzY3JpcHRpb24iLCJzcmMiLCJhbHQiLCJjb25maXJtYXRpb25Qb3B1cCIsIl9tb2RhbEVsZW1lbnQiLCJfc3VibWl0QnV0dG9uIiwic2V0U3VibWl0QWN0aW9uIiwiaGFuZGxlU3VibWl0IiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfZGVzY3JpcHRpb25FbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJyb2xlIiwic2V0VXNlckluZm8iLCJzZXRBdmF0YXIiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJjcmVhdGVGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsImNhcmRzTGlzdCIsImNyZWF0ZUNhcmQiLCJkYXRhIiwidXNlcklkIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZVVzZXJMaWtlcyIsIl9pZCIsIl9kYXRhIiwiX3VzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlVXNlckxpa2VzIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImhhbmRsZURlbGV0ZUNhcmQiLCJfZWxlbWVudCIsInNldExpa2VzIiwiX3JlbmRlckxpa2VzIiwiaXNMaWtlZCIsInNvbWUiLCJpbWFnZUNvdW50RWxlbWVudCIsImxlbmd0aCIsImltYWdlTGlrZUVsZW1lbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJnZW5lcmF0ZUNhcmQiLCJpbWFnZUVsZW1lbnQiLCJpbWFnZUVsZW1lbnRUZXh0IiwiaW1hZ2VEZWxldGVFbGVtZW50IiwiZ2V0Q2FyZElkIiwiZGVsZXRlQ2FyZEJ5SWQiLCJ0aGVuIiwiY2F0Y2giLCJlcnJvciIsImZpbmFsbHkiLCJjaGFuZ2VDYXJkTGlrZVN0YXR1cyIsImFkZEZvcm1Nb2RhbCIsIlBvcHVwV2l0aEZvcm0iLCJhZGRDYXJkIiwiYWRkSXRlbSIsImF2YXRhckZvcm1Nb2RhbCIsInNldFVzZXJBdmF0YXIiLCJmaWxsUHJvZmlsZUZvcm0iLCJlZGl0Rm9ybU1vZGFsIiwiZWRpdFVzZXJJbmZvIiwidXNlciIsImNhcmRzIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsInByZXBlbmQiXSwic291cmNlUm9vdCI6IiJ9