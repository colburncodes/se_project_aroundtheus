!function(){"use strict";function e(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var r=class{constructor(e,r){t(this,"_showInputError",(e=>{const t=document.querySelector(`.${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass),e.classList.add(this._settings.inputErrorClass)})),t(this,"_hideInputError",(e=>{const t=document.querySelector(`.${e.id}-error`);t.textContent="",e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass)})),t(this,"_checkInputValidity",((e,t)=>{e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)})),t(this,"_checkFormValidity",(()=>[...this._formElement.querySelectorAll(this._settings.inputSelector)].every((e=>e.validity.valid)))),t(this,"_toggleButtonState",(()=>{const e=this._checkFormValidity(),t=this._formElement.querySelector(this._settings.submitButtonSeletor);e?(t.classList.remove(this._settings.inactiveButtonClass),t.removeAttribute("disabled")):(t.setAttribute("disabled","true"),t.classList.add(this._settings.inactiveButtonClass))})),this._formElement=e,this._settings=r}enableValidation(){Array.from(document.querySelectorAll(this._settings.formSelector)).forEach((e=>{e.addEventListener("submit",(function(e){e.preventDefault()}));const t=[...e.querySelectorAll(this._settings.inputSelector)];this._toggleButtonState(),e.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}),0)})),t.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e,this._settings),this._toggleButtonState()}))}))}))}};function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=class{constructor(e){n(this,"_handleCloseButton",(()=>{this.closeModal()})),n(this,"_handleEscapePopup",(e=>{"Escape"===e.key&&this.closeModal()})),n(this,"_handleModalOverlay",(e=>{e.target.classList.contains(".modal")&&this.closeModal()})),this._popupElement=document.querySelector(`${e}`)}openModal(){this._popupElement.classList.add("modal__open"),document.addEventListener("keyup",this._handleEscapePopup)}closeModal(){this._popupElement.classList.remove("modal__open"),document.removeEventListener("keyup",this._handleEscapePopup)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal__open")&&this.closeModal(),e.target.classList.contains("modal__close")&&this.closeModal()}))}},i=class extends s{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super(t),this._modalForm=this._popupElement.querySelector(".modal__form"),this._inputs=this._modalForm.querySelectorAll(".modal__input"),this._handleFormSubmit=r}_getInputValues(){return this._formValues={},this._inputs.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}closeModal(){this._modalForm.reset(),super.closeModal()}};const o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSeletor:".modal__save-button",inactiveButtonClass:"modal__button-disabled",inputErrorClass:"modal__input-error",errorClass:"modal__error_visible"},a=document.querySelector(".modal__form-create"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".profile__edit-button"),d=document.querySelector(".modal__input-profile-name"),h=document.querySelector(".modal__input-profile-description"),u=new class{constructor(t){let{baseUrl:r,authToken:n}=t;e(this,"getInitialCards",(async()=>await fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._authToken}}).then(this._handleResponse).catch((e=>this._handleResponseError(e))))),e(this,"addCard",(async e=>{let{name:t,link:r}=e;return await fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then(this._handleResponse).catch((e=>this._handleResponseError(e)))})),e(this,"deleteCardById",(async e=>await fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(this._handleResponse).catch((e=>this._handleResponseError(e))))),e(this,"getUserInfo",(async()=>await fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authToken}}).then(this._handleResponse).catch((e=>this._handleResponseError(e))))),e(this,"editUserInfo",(async e=>{let{name:t,about:r}=e;return await fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:r})}).then(this._handleResponse).catch((e=>this._handleResponseError(e)))})),e(this,"addUserLikes",(async e=>await fetch(`${this._baseUrl}/cards/likes/${e}`,{method:"PUT",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(this._handleResponse).catch((e=>this._handleResponseError(e))))),this._baseUrl=r,this._authToken=n}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} ${e.statusText}`)}_handleResponseError(e){console.log(`Error processing request ${e}`)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",authToken:"db0cb0b5-b0ef-4843-a8af-9c3db60e50cb"}),m=document.querySelector("#modal__edit"),_=document.querySelector("#modal__create"),p=new class extends s{open(e){let{name:t,link:r}=e;this._imageElement=document.querySelector("#image-modal"),super.setEventListeners();const n=this._imageElement.querySelector(".modal__preview-image"),s=this._imageElement.querySelector(".modal__caption");n.src=r,n.alt=t,s.textContent=t,super.openModal()}}("#image-modal"),y=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,role:this._descriptionElement.textContent}}setUserInfo(e){let{name:t,about:r}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=r}}(".profile__title",".profile__description");u.getUserInfo().then((e=>{y.setUserInfo({name:e.name,about:e.about})})).catch((e=>{console.error(e)}));const f=new r(m,o),v=new r(_,o);l.addEventListener("click",(()=>{b.openModal()}));const b=new i({popupSelector:"#modal__create",handleFormSubmit:e=>{u.addCard(e).then((e=>e)).catch((e=>{console.error(e)})),a.reset(),b.closeModal()}});c.addEventListener("click",(()=>{const{name:e,role:t}=y.getUserInfo();d.value=e,h.value=t,g.openModal()}));const g=new i({popupSelector:"#modal__edit",handleFormSubmit:e=>{u.editUserInfo(e).then((e=>{y.setUserInfo({name:e.name,about:e.about})})).catch((e=>{console.error(e)})),g.closeModal()}});u.getInitialCards().then((e=>{console.log(e);const t=new class{constructor(e,t){let{items:r,renderer:n}=e;this._items=r,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:e,renderer:e=>{const r=new class{constructor(e,t){let{data:r,handleImageClick:n,handleDeleteClick:s,handleUserLikes:i}=e;var o,a,l;o=this,l=()=>this._element.querySelector(".card__like-button").classList.toggle("card__like-active"),(a=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(a="handleLikeIcon"))in o?Object.defineProperty(o,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[a]=l,this._id=r._id,this._ownerId=r.owner._id,this._name=r.name,this._link=r.link,this._likes=r.likes,this._cardSelector=t,this._handleImageClick=n,this._handleDeleteClick=s,this._handleUserLikes=i}getById(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}handleDeleteCard(){this._element.remove(),this._element=null}_setEventListeners(){this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteClick())),this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleUserLikes())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handleImageClick({name:this._name,src:this._link})))}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__label-text");return e.src=this._link,e.alt=this._name,t.textContent=this._name,this._element}}({data:e,handleImageClick:()=>{p.open(e)},handleDeleteClick:()=>{const e=r.getById();u.deleteCardById(e).then((()=>{r.handleDeleteCard(),console.log("Card was deleted successfully")})).catch((e=>console.error(e)))},handleUserLikes:()=>{const e=r.getById();u.addUserLikes(e).then((()=>{r.handleLikeIcon()}))}},"#card-template");t.addItem(r.generateCard())}},".cards__list");t.renderItems()})).catch((e=>{console.error(e)})),g.setEventListeners(),b.setEventListeners(),p.setEventListeners(),f.enableValidation(),v.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNiaUQsRUFBV2pELG9CQUVYa0UsRUFBa0J2RixtQkFDbEJ5RixFQUFvQnpGLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgc2V0dGluZ3MpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0KSA9PiB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSA9IChpbnB1dCwgc2V0dGluZ3MpID0+IHtcbiAgICBpZiAoaW5wdXQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0LCBzZXR0aW5ncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0LCBzZXR0aW5ncyk7XG4gICAgfVxuICB9O1xuXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSA9ICgpID0+IHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBbXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxuICAgIF07XG4gICAgcmV0dXJuIGlucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfTtcblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUgPSAoKSA9PiB7XG4gICAgY29uc3QgaXNWYWxpZCA9IHRoaXMuX2NoZWNrRm9ybVZhbGlkaXR5KCk7XG4gICAgY29uc3QgYnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGV0b3JcbiAgICApO1xuICAgIGlmIChpc1ZhbGlkKSB7XG4gICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIH1cbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuZm9ybVNlbGVjdG9yKVxuICAgICk7XG5cbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSk7XG4gICAgICBjb25zdCBpbnB1dHMgPSBbXG4gICAgICAgIC4uLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXG4gICAgICBdO1xuXG4gICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgfSwgMCk7IC8vIGl04oCZcyBlbm91Z2ggdG8gcHV0IDAgbXMgaGVyZVxuICAgICAgfSk7XG5cbiAgICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCwgdGhpcy5fc2V0dGluZ3MpO1xuICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7cG9wdXBTZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIG9wZW5Nb2RhbCgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NhcGVQb3B1cCk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY2FwZVBvcHVwKTtcbiAgfVxuXG4gIF9oYW5kbGVDbG9zZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgfTtcblxuICBfaGFuZGxlRXNjYXBlUG9wdXAgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlTW9kYWxPdmVybGF5ID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIi5tb2RhbFwiKSkge1xuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19vcGVuXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaChcbiAgICAgIChpbnB1dCkgPT4gKHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSlcbiAgICApO1xuICAgIHJldHVybiB0aGlzLl9mb3JtVmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHRoaXMuX21vZGFsRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlTW9kYWwoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xuIiwiZXhwb3J0IGNvbnN0IEJBU0VfVVJMID0gXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCI7XG5leHBvcnQgY29uc3QgQVVUSF9UT0tFTiA9IFwiZGIwY2IwYjUtYjBlZi00ODQzLWE4YWYtOWMzZGI2MGU1MGNiXCI7XG5cbi8vIHZhbGlkYXRpb24gYWN0aXZhdGlvblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRGb3JtQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxldG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uLWRpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbiAgY2FyZHNTZWN0aW9uOiBcIi5jYXJkc19fbGlzdFwiLFxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgYWRkTW9kYWw6IFwiI21vZGFsX19jcmVhdGVcIixcbiAgZWRpdE1vZGFsOiBcIiNtb2RhbF9fZWRpdFwiLFxuICBpbWFnZU1vZGFsOiBcIiNtb2RhbC1pbWFnZVwiLFxuICBjYXJkTW9kYWxGb3JtOiBcIi5tb2RhbF9fZm9ybS1jcmVhdGVcIixcbiAgcHJvZmlsZU1vZGFsRm9ybTogXCIubW9kYWxfX2Zvcm0tZWRpdFwiLFxuICBtb2RhbFNlbGVjdG9yOiBcIi5tb2RhbFwiLFxuICBwcm9maWxlVGl0bGU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbn07XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVNb2RhbEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtLWNyZWF0ZVwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5leHBvcnQgY29uc3QgZWRpdFVzZXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVJbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9faW5wdXQtcHJvZmlsZS1uYW1lXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUlucHV0RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9faW5wdXQtcHJvZmlsZS1kZXNjcmlwdGlvblwiXG4pO1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5cbmltcG9ydCB7XG4gIHNlbGVjdG9ycyxcbiAgY3JlYXRlTW9kYWxGb3JtLFxuICBhZGRDYXJkQnV0dG9uLFxuICBlZGl0VXNlckJ1dHRvbixcbiAgcHJvZmlsZUlucHV0TmFtZSxcbiAgcHJvZmlsZUlucHV0RGVzY3JpcHRpb24sXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxuICBCQVNFX1VSTCxcbiAgQVVUSF9UT0tFTixcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogQkFTRV9VUkwsXG4gIGF1dGhUb2tlbjogQVVUSF9UT0tFTixcbn0pO1xuXG5jb25zdCBlZGl0VXNlck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fZWRpdFwiKTtcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2NyZWF0ZVwiKTtcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBzZWxlY3RvcnMucHJvZmlsZVRpdGxlLFxuICBzZWxlY3RvcnMucHJvZmlsZURlc2NyaXB0aW9uXG4pO1xuXG5hcGlcbiAgLmdldFVzZXJJbmZvKClcbiAgLnRoZW4oKHVzZXIpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICBhYm91dDogdXNlci5hYm91dCxcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG4vLyBhcGlcbi8vICAgLmFkZFVzZXJMaWtlcyhcIjYzOWRjNmVmNjBjZjkwMWVlY2Q4M2QyZlwiKVxuLy8gICAudGhlbigobGlrZSkgPT4gY29uc29sZS5sb2cobGlrZSkpXG4vLyAgIC5jYXRjaCgoZXJyKSA9PiB7XG4vLyAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuLy8gICB9KTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihlZGl0VXNlck1vZGFsLCBkZWZhdWx0Rm9ybUNvbmZpZyk7XG5jb25zdCBjcmVhdGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoYWRkQ2FyZE1vZGFsLCBkZWZhdWx0Rm9ybUNvbmZpZyk7XG5cbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybU1vZGFsLm9wZW5Nb2RhbCgpO1xufSk7XG5cbmNvbnN0IGFkZEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmFkZE1vZGFsLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xuICAgIGFwaVxuICAgICAgLmFkZENhcmQoZGF0YSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiBkYXRhKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gICAgY3JlYXRlTW9kYWxGb3JtLnJlc2V0KCk7XG4gICAgYWRkRm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgfSxcbn0pO1xuXG5lZGl0VXNlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIHJvbGUgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVJbnB1dE5hbWUudmFsdWUgPSBuYW1lO1xuICBwcm9maWxlSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHJvbGU7XG4gIGVkaXRGb3JtTW9kYWwub3Blbk1vZGFsKCk7XG59KTtcblxuY29uc3QgZWRpdEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmVkaXRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBhcGlcbiAgICAgIC5lZGl0VXNlckluZm8oZGF0YSlcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICAgIGVkaXRGb3JtTW9kYWwuY2xvc2VNb2RhbCgpO1xuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0SW5pdGlhbENhcmRzKClcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XG4gICAgY29uc29sZS5sb2coY2FyZHMpO1xuICAgIGNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgICAgaGFuZGxlSW1hZ2VDbGljazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIGltYWdlUG9wdXAub3BlbihkYXRhKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlRGVsZXRlQ2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYXJkSWQgPSBjYXJkLmdldEJ5SWQoKTtcbiAgICAgICAgICAgICAgICBhcGlcbiAgICAgICAgICAgICAgICAgIC5kZWxldGVDYXJkQnlJZChjYXJkSWQpXG4gICAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQ2FyZCB3YXMgZGVsZXRlZCBzdWNjZXNzZnVsbHlgKTtcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgaGFuZGxlVXNlckxpa2VzOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FyZElkID0gY2FyZC5nZXRCeUlkKCk7XG4gICAgICAgICAgICAgICAgYXBpLmFkZFVzZXJMaWtlcyhjYXJkSWQpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIlxuICAgICAgICAgICk7XG4gICAgICAgICAgY2FyZHNMaXN0LmFkZEl0ZW0oY2FyZC5nZW5lcmF0ZUNhcmQoKSk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgc2VsZWN0b3JzLmNhcmRzU2VjdGlvblxuICAgICk7XG4gICAgY2FyZHNMaXN0LnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuZWRpdEZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkRm9ybU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmNyZWF0ZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhdXRoVG9rZW4gfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2F1dGhUb2tlbiA9IGF1dGhUb2tlbjtcbiAgfVxuXG4gIF9oYW5kbGVSZXNwb25zZShyZXNwb25zZSkge1xuICAgIHJldHVybiByZXNwb25zZS5va1xuICAgICAgPyByZXNwb25zZS5qc29uKClcbiAgICAgIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICB9XG5cbiAgX2hhbmRsZVJlc3BvbnNlRXJyb3IoZXJyKSB7XG4gICAgY29uc29sZS5sb2coYEVycm9yIHByb2Nlc3NpbmcgcmVxdWVzdCAke2Vycn1gKTtcbiAgfVxuXG4gIC8vIEdFVDogTGlzdCBvZiBjYXJkc1xuICBnZXRJbml0aWFsQ2FyZHMgPSBhc3luYyAoKSA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogeyBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4gfSxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXG4gICAgICAuY2F0Y2goKGVycikgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2VFcnJvcihlcnIpKTtcbiAgfTtcblxuICAvLyBQT1NUOiBBZGQgbmV3IGNhcmRcbiAgYWRkQ2FyZCA9IGFzeW5jICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICAgIHJldHVybiBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlRXJyb3IoZXJyKSk7XG4gIH07XG5cbiAgLy8gREVMRVRFOiBEZWxldGUgY2FyZFxuICBkZWxldGVDYXJkQnlJZCA9IGFzeW5jIChpZCkgPT4ge1xuICAgIHJldHVybiBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGlkLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHRoaXMuX2hhbmRsZVJlc3BvbnNlRXJyb3IoZXJyKSk7XG4gIH07XG5cbiAgLy8gR0VUOiBHZXRzIFVzZXIgUHJvZmlsZVxuICBnZXRVc2VySW5mbyA9IGFzeW5jICgpID0+IHtcbiAgICByZXR1cm4gYXdhaXQgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbiB9LFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZUVycm9yKGVycikpO1xuICB9O1xuXG4gIC8vIFBBVENIOiBFZGl0IFVzZXIgUHJvZmlsZVxuICBlZGl0VXNlckluZm8gPSBhc3luYyAoeyBuYW1lLCBhYm91dCB9KSA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhUb2tlbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pXG4gICAgICAudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB0aGlzLl9oYW5kbGVSZXNwb25zZUVycm9yKGVycikpO1xuICB9O1xuXG4gIC8vIFBVVDogQWRkIFVzZXIgbGlrZXNcbiAgYWRkVXNlckxpa2VzID0gYXN5bmMgKGlkKSA9PiB7XG4gICAgcmV0dXJuIGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaWQsXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpXG4gICAgICAuY2F0Y2goKGVycikgPT4gdGhpcy5faGFuZGxlUmVzcG9uc2VFcnJvcihlcnIpKTtcbiAgfTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtbW9kYWxcIik7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2ltYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCIpO1xuICAgIGNvbnN0IGNhcmREZXNjcmlwdGlvbiA9IHRoaXMuX2ltYWdlRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4gICAgY2FyZEltYWdlLnNyYyA9IGxpbms7XG4gICAgY2FyZEltYWdlLmFsdCA9IG5hbWU7XG4gICAgY2FyZERlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3BXaXRoSW1hZ2U7XG4iLCJjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb25TZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICByb2xlOiB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcbiIsImNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IGRhdGEsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVVc2VyTGlrZXMgfSxcbiAgICBjYXJkU2VsZWN0b3JcbiAgKSB7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVVc2VyTGlrZXMgPSBoYW5kbGVVc2VyTGlrZXM7XG4gIH1cblxuICBnZXRCeUlkKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZTtcbiAgfVxuXG4gIGhhbmRsZUxpa2VJY29uID0gKCkgPT5cbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWFjdGl2ZVwiKTtcblxuICBoYW5kbGVEZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDbGljaygpKTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZVVzZXJMaWtlcygpKTtcblxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soe1xuICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgICBzcmM6IHRoaXMuX2xpbmssXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgY29uc3QgaW1hZ2VFbGVtZW50VGV4dCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19sYWJlbC10ZXh0XCIpO1xuXG4gICAgaW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgaW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XG4gICAgaW1hZ2VFbGVtZW50VGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJzZXR0aW5ncyIsImlucHV0IiwiZXJyb3JFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwidGhpcyIsIl9zZXR0aW5ncyIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJyZW1vdmUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiX2Zvcm1FbGVtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJldmVyeSIsImlzVmFsaWQiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJidXR0b24iLCJzdWJtaXRCdXR0b25TZWxldG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJBcnJheSIsImZyb20iLCJmb3JtU2VsZWN0b3IiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiaW5wdXRzIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwic2V0VGltZW91dCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJwb3B1cFNlbGVjdG9yIiwiY2xvc2VNb2RhbCIsImtleSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsIm9wZW5Nb2RhbCIsIl9oYW5kbGVFc2NhcGVQb3B1cCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX21vZGFsRm9ybSIsIl9pbnB1dHMiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwibmFtZSIsInZhbHVlIiwicmVzZXQiLCJkZWZhdWx0Rm9ybUNvbmZpZyIsImNyZWF0ZU1vZGFsRm9ybSIsImFkZENhcmRCdXR0b24iLCJlZGl0VXNlckJ1dHRvbiIsInByb2ZpbGVJbnB1dE5hbWUiLCJwcm9maWxlSW5wdXREZXNjcmlwdGlvbiIsImFwaSIsImJhc2VVcmwiLCJhdXRoVG9rZW4iLCJhc3luYyIsImZldGNoIiwiX2Jhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsIl9hdXRoVG9rZW4iLCJ0aGVuIiwiX2hhbmRsZVJlc3BvbnNlIiwiY2F0Y2giLCJlcnIiLCJfaGFuZGxlUmVzcG9uc2VFcnJvciIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwicmVzcG9uc2UiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImNvbnNvbGUiLCJsb2ciLCJlZGl0VXNlck1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwiaW1hZ2VQb3B1cCIsIm9wZW4iLCJfaW1hZ2VFbGVtZW50IiwiY2FyZEltYWdlIiwiY2FyZERlc2NyaXB0aW9uIiwic3JjIiwiYWx0IiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJkZXNjcmlwdGlvblNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsImdldFVzZXJJbmZvIiwicm9sZSIsInNldFVzZXJJbmZvIiwidXNlciIsImVycm9yIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiY3JlYXRlRm9ybVZhbGlkYXRvciIsImFkZEZvcm1Nb2RhbCIsIlBvcHVwV2l0aEZvcm0iLCJkYXRhIiwiYWRkQ2FyZCIsImVkaXRGb3JtTW9kYWwiLCJlZGl0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJjYXJkcyIsImNhcmRzTGlzdCIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCIsImNhcmQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVVc2VyTGlrZXMiLCJfZWxlbWVudCIsInRvZ2dsZSIsIl9pZCIsIl9vd25lcklkIiwib3duZXIiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlVXNlckxpa2VzIiwiZ2V0QnlJZCIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJoYW5kbGVEZWxldGVDYXJkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZ2VuZXJhdGVDYXJkIiwiaW1hZ2VFbGVtZW50IiwiaW1hZ2VFbGVtZW50VGV4dCIsImNhcmRJZCIsImRlbGV0ZUNhcmRCeUlkIiwiYWRkVXNlckxpa2VzIiwiaGFuZGxlTGlrZUljb24iXSwic291cmNlUm9vdCI6IiJ9