!function(){"use strict";function e(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=class{constructor(e,t){r(this,"_showInputError",(e=>{const t=document.querySelector(`.${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass),e.classList.add(this._settings.inputErrorClass)})),r(this,"_hideInputError",(e=>{const t=document.querySelector(`.${e.id}-error`);t.textContent="",e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass)})),r(this,"_checkInputValidity",((e,t)=>{e.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)})),r(this,"_checkFormValidity",(()=>[...this._formElement.querySelectorAll(this._settings.inputSelector)].every((e=>e.validity.valid)))),r(this,"_toggleButtonState",(()=>{this._checkFormValidity()?(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.removeAttribute("disabled")):(this._buttonElement.setAttribute("disabled","true"),this._buttonElement.classList.add(this._settings.inactiveButtonClass))})),this._formElement=e,this._settings=t,this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSeletor)}enableValidation(){Array.from(document.querySelectorAll(this._settings.formSelector)).forEach((e=>{e.addEventListener("submit",(function(e){e.preventDefault()}));const t=[...e.querySelectorAll(this._settings.inputSelector)];this._toggleButtonState(),e.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}),0)})),t.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e,this._settings),this._toggleButtonState()}))}))}))}};function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=class{constructor(e){n(this,"_handleCloseButton",(()=>{this.closeModal()})),n(this,"_handleEscapePopup",(e=>{"Escape"===e.key&&this.closeModal()})),n(this,"_handleModalOverlay",(e=>{e.target.classList.contains(".modal")&&this.closeModal()})),this._popupElement=document.querySelector(`${e}`)}openModal(){this._popupElement.classList.add("modal__open"),document.addEventListener("keyup",this._handleEscapePopup)}closeModal(){this._popupElement.classList.remove("modal__open"),document.removeEventListener("keyup",this._handleEscapePopup)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal__open")&&this.closeModal(),e.target.classList.contains("modal__close")&&this.closeModal()}))}},o=class extends i{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super(t),this._modalForm=this._popupElement.querySelector(".modal__form"),this._inputs=this._modalForm.querySelectorAll(".modal__input"),this._handleFormSubmit=r,this._buttonElement=this._modalForm.querySelector(".modal__save-button")}_getInputValues(){return this._formValues={},this._inputs.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}renderLoading(e){this._buttonElement.textContent=e?"Saving...":"Save"}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}closeModal(){this._modalForm.reset(),super.closeModal()}};const a="db0cb0b5-b0ef-4843-a8af-9c3db60e50cb",l={authorization:a,"Content-Type":"application/json"},d={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSeletor:".modal__save-button",inactiveButtonClass:"modal__button-disabled",inputErrorClass:"modal__input-error",errorClass:"modal__error_visible"},c=document.querySelector(".modal__form-create"),u=document.querySelector(".profile__add-button"),h=document.querySelector(".profile__avatar-edit"),_=document.querySelector(".profile__edit-button"),m=document.querySelector(".modal__input-profile-name"),p=document.querySelector(".modal__input-profile-description"),v=(document.querySelector(".card__like-button"),new class{constructor(t){let{baseUrl:r,authToken:s,headers:n}=t;e(this,"getInitialCards",(async()=>{const e=await fetch(`${this._baseUrl}/cards`,{headers:this._headers});return this._handleResponse(e)})),e(this,"addCard",(async e=>{let{name:t,link:r}=e;const s=await fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})});return this._handleResponse(s)})),e(this,"deleteCardById",(async e=>{const t=await fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers,body:JSON.stringify({id:e})});return this._handleResponse(t)})),e(this,"getUserInfo",(async()=>{const e=await fetch(`${this._baseUrl}/users/me`,{headers:this._headers});return this._handleResponse(e)})),e(this,"editUserInfo",(async e=>{let{name:t,about:r}=e;const s=await fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})});return this._handleResponse(s)})),e(this,"setUserAvatar",(async e=>{let{avatar:t}=e;const r=await fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})});return this._handleResponse(r)})),e(this,"changeCardLikeStatus",(async(e,t)=>{const r=await fetch(`${this._baseUrl}/cards/likes/${e}`,{method:t?"PUT":"DELETE",headers:this._headers,body:JSON.stringify({like:t})});return this._handleResponse(r)})),this._baseUrl=r,this._authToken=s,this._headers=n}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status} ${e.statusText}`)}_handleResponseError(e){console.log(`Error processing request ${e}`)}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",authToken:a,headers:l})),b=document.querySelector("#modal__edit"),y=document.querySelector("#modal__create"),f=document.querySelector("#avatar-modal"),g=new class extends i{open(e){let{name:t,link:r}=e;this._imageElement=document.querySelector("#image-modal"),super.setEventListeners();const s=this._imageElement.querySelector(".modal__preview-image"),n=this._imageElement.querySelector(".modal__caption");s.src=r,s.alt=t,n.textContent=t,super.openModal()}}("#image-modal"),S=new class extends i{constructor(e){super(e),this._modalElement=document.querySelector(e),this._submitButton=this._modalElement.querySelector(".modal__save-button")}renderLoading(e){this._submitButton.textContent=e?"Deleting...":"Yes"}setSubmitAction(e){this._submitButton.addEventListener("click",e)}setEventListeners(){super.setEventListeners(),this._submitButton.classList.remove("modal__button-disabled")}}("#delete-modal"),E=new class{constructor(e,t,r){this._nameElement=document.querySelector(e),this._descriptionElement=document.querySelector(t),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,role:this._descriptionElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,about:r}=e;this._nameElement.textContent=t,this._descriptionElement.textContent=r}setAvatar(e){this._avatarElement.src=e}}(".profile__title",".profile__description",".profile__image"),L=new s(b,d),k=new s(y,d),C=new s(f,d);function q(e,r){const s=new class{constructor(e,r){let{data:s,userId:n,handleImageClick:i,handleDeleteClick:o,handleUserLikes:a}=e;t(this,"getCardId",(()=>this._id)),t(this,"handleLikeIcon",(()=>{this._element.querySelector(".card__like-button").classList.toggle("card__like-active")})),this._data=s,this._id=s._id,this._userId=n,this._ownerId=s.owner._id,this._name=s.name,this._link=s.link,this._likes=s.likes,this._cardSelector=r,this._handleImageClick=i,this._handleDeleteClick=o,this._handleUserLikes=a}getUserLikesCount(){if(this._likes.length>0)return this._likes.length}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}handleDeleteCard(){this._element.remove()}setLikes(e){this._likes=e,this._renderLikes()}isLiked(){}renderLikes(){this.isLiked()?this._element.querySelector(".card__like-button").classList.add("card__like-active"):this._element.querySelector(".card__like-button").classList.remove("card__like-active")}_setEventListeners(){this._element.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteClick())),this._element.querySelector(".card__like-button").addEventListener("click",(()=>this._handleUserLikes())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handleImageClick({name:this._name,src:this._link})))}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__label-text"),r=this._element.querySelector(".card__like-count");return e.src=this._link,e.alt=this._name,t.textContent=this._name,r.textContent=this.getUserLikesCount(),this._userId==this._ownerId?this.handleDeleteCard():this._element.querySelector(".card__delete-button").remove(),this._element}}({data:e,userId:r,handleImageClick:()=>{g.open(e)},handleDeleteClick:()=>{const e=s.getCardId();S.openModal(),S.setSubmitAction((()=>{S.renderLoading(!0),v.deleteCardById(e).then((()=>{s.handleDeleteCard(),S.closeModal()})).catch((e=>console.error(e))).finally((()=>S.renderLoading(!1)))}))},handleUserLikes:()=>{const e=s.getCardId(),t=s.getUserLikesCount();v.changeCardLikeStatus(e,t).then((()=>{s.handleLikeIcon()})).catch((e=>console.error(e)))}},"#card-template");return s.generateCard()}u.addEventListener("click",(()=>{I.openModal()}));const I=new o({popupSelector:"#modal__create",handleFormSubmit:e=>{I.renderLoading(!0),v.addCard(e).then((e=>{q(e),c.reset(),I.closeModal()})).catch((e=>{console.error(e)})).finally((()=>I.renderLoading(!1)))}});h.addEventListener("click",(()=>{w.openModal()}));const w=new o({popupSelector:"#avatar-modal",handleFormSubmit:e=>{w.renderLoading(!0),v.setUserAvatar(e).then((e=>{E.setAvatar(e),w.closeModal()})).catch((e=>console.log(e))).finally((()=>w.renderLoading(!1)))}});_.addEventListener("click",(()=>{const{name:e,role:t}=E.getUserInfo();(e=>{let{name:t,role:r}=e;m.value=t,p.value=r})({name:e,role:t}),U.openModal()}));const U=new o({popupSelector:"#modal__edit",handleFormSubmit:e=>{U.renderLoading(!0),v.editUserInfo(e).then((e=>{E.setUserInfo({name:e.name,about:e.about,avatar:e.avatar}),U.closeModal()})).catch((e=>{console.error(e)})).finally((()=>U.renderLoading(!1)))}});v.getAppInfo().then((e=>{let[t,r]=e;E.setUserInfo({name:t.name,about:t.about});const s=t.avatar;E.setAvatar(s);const n=t._id,i=new class{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:r,renderer:e=>{const t=q(e,n);i.addItem(t)}},".cards__list");i.renderItems()})).catch((e=>{console.error(e)})),I.setEventListeners(),w.setEventListeners(),S.setEventListeners(),U.setEventListeners(),g.setEventListeners(),C.enableValidation(),k.enableValidation(),L.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU9ILEVBQVdDLEVBQU1DLEdBQzlCc0QsRUFBVVMsUUFBUTlELEVBQUssR0QvSmpCLGdCQ29LWnFELEVBQVVPLGFBQWEsSUFFeEJ0QixPQUFPN0UsSUFDTkMsUUFBUTZFLE1BQU05RSxFQUFJLElBR3RCa0YsRUFBYXJJLG9CQUNid0ksRUFBZ0J4SSxvQkFDaEJvRSxFQUFrQnBFLG9CQUNsQjJJLEVBQWMzSSxvQkFDZDZELEVBQVc3RCxvQkFFWHNGLEVBQW9CM0csbUJBQ3BCMEcsRUFBb0IxRyxtQkFDcEJ3RyxFQUFrQnhHLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgc2V0dGluZ3MpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxldG9yXG4gICAgKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dCkgPT4ge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0LmlkfS1lcnJvcmApO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgfTtcblxuICBfaGlkZUlucHV0RXJyb3IgPSAoaW5wdXQpID0+IHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgfTtcblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGlucHV0LCBzZXR0aW5ncykgPT4ge1xuICAgIGlmIChpbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQsIHNldHRpbmdzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXQsIHNldHRpbmdzKTtcbiAgICB9XG4gIH07XG5cbiAgX2NoZWNrRm9ybVZhbGlkaXR5ID0gKCkgPT4ge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IFtcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXG4gICAgXTtcblxuICAgIHJldHVybiBpbnB1dExpc3QuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XG4gIH07XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IGlzVmFsaWQgPSB0aGlzLl9jaGVja0Zvcm1WYWxpZGl0eSgpO1xuXG4gICAgaWYgKGlzVmFsaWQpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIH1cbiAgfTtcblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuZm9ybVNlbGVjdG9yKVxuICAgICk7XG5cbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfSk7XG4gICAgICBjb25zdCBpbnB1dHMgPSBbXG4gICAgICAgIC4uLmZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXG4gICAgICBdO1xuXG4gICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgICAgfSwgMCk7IC8vIGl04oCZcyBlbm91Z2ggdG8gcHV0IDAgbXMgaGVyZVxuICAgICAgfSk7XG5cbiAgICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCwgdGhpcy5fc2V0dGluZ3MpO1xuICAgICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCR7cG9wdXBTZWxlY3Rvcn1gKTtcbiAgfVxuXG4gIG9wZW5Nb2RhbCgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NhcGVQb3B1cCk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY2FwZVBvcHVwKTtcbiAgfVxuXG4gIF9oYW5kbGVDbG9zZUJ1dHRvbiA9ICgpID0+IHtcbiAgICB0aGlzLmNsb3NlTW9kYWwoKTtcbiAgfTtcblxuICBfaGFuZGxlRXNjYXBlUG9wdXAgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgIH1cbiAgfTtcblxuICBfaGFuZGxlTW9kYWxPdmVybGF5ID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIi5tb2RhbFwiKSkge1xuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19vcGVuXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idXR0b25cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKFxuICAgICAgKGlucHV0KSA9PiAodGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKVxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZU1vZGFsKCkge1xuICAgIHRoaXMuX21vZGFsRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlTW9kYWwoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xuIiwiZXhwb3J0IGNvbnN0IEJBU0VfVVJMID0gXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCI7XG5leHBvcnQgY29uc3QgQVVUSF9UT0tFTiA9IFwiZGIwY2IwYjUtYjBlZi00ODQzLWE4YWYtOWMzZGI2MGU1MGNiXCI7XG5leHBvcnQgY29uc3QgSEVBREVSUyA9IHtcbiAgYXV0aG9yaXphdGlvbjogQVVUSF9UT0tFTixcbiAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG59O1xuXG4vLyB2YWxpZGF0aW9uIGFjdGl2YXRpb25cbmV4cG9ydCBjb25zdCBkZWZhdWx0Rm9ybUNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZXRvcjogXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbi1kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XG4gIGNhcmRzU2VjdGlvbjogXCIuY2FyZHNfX2xpc3RcIixcbiAgY2FyZFRlbXBsYXRlOiBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gIGFkZE1vZGFsOiBcIiNtb2RhbF9fY3JlYXRlXCIsXG4gIGVkaXRNb2RhbDogXCIjbW9kYWxfX2VkaXRcIixcbiAgYXZhdGFyTW9kYWw6IFwiI2F2YXRhci1tb2RhbFwiLFxuICBpbWFnZU1vZGFsOiBcIiNtb2RhbC1pbWFnZVwiLFxuICBkZWxldGVNb2RhbDogXCIjZGVsZXRlLW1vZGFsXCIsXG4gIGNhcmRNb2RhbEZvcm06IFwiLm1vZGFsX19mb3JtLWNyZWF0ZVwiLFxuICBwcm9maWxlTW9kYWxGb3JtOiBcIi5tb2RhbF9fZm9ybS1lZGl0XCIsXG4gIG1vZGFsU2VsZWN0b3I6IFwiLm1vZGFsXCIsXG4gIHByb2ZpbGVJbWFnZTogXCIucHJvZmlsZV9faW1hZ2VcIixcbiAgcHJvZmlsZVRpdGxlOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBwcm9maWxlRGVzY3JpcHRpb246IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG59O1xuXG5leHBvcnQgY29uc3QgY3JlYXRlTW9kYWxGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybS1jcmVhdGVcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItZWRpdFwiKTtcbmV4cG9ydCBjb25zdCBlZGl0VXNlckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbnB1dC1wcm9maWxlLW5hbWVcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlSW5wdXREZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbnB1dC1wcm9maWxlLWRlc2NyaXB0aW9uXCJcbik7XG5cbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uXCI7XG5cbmltcG9ydCB7XG4gIHNlbGVjdG9ycyxcbiAgY3JlYXRlTW9kYWxGb3JtLFxuICBhZGRDYXJkQnV0dG9uLFxuICBlZGl0VXNlckJ1dHRvbixcbiAgYXZhdGFySWNvbixcbiAgcHJvZmlsZUlucHV0TmFtZSxcbiAgcHJvZmlsZUlucHV0RGVzY3JpcHRpb24sXG4gIGRlZmF1bHRGb3JtQ29uZmlnLFxuICBCQVNFX1VSTCxcbiAgQVVUSF9UT0tFTixcbiAgSEVBREVSUyxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogQkFTRV9VUkwsXG4gIGF1dGhUb2tlbjogQVVUSF9UT0tFTixcbiAgaGVhZGVyczogSEVBREVSUyxcbn0pO1xuXG5jb25zdCBlZGl0VXNlck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbF9fZWRpdFwiKTtcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWxfX2NyZWF0ZVwiKTtcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLW1vZGFsXCIpO1xuXG5jb25zdCBjb25maXJtYXRpb25Qb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oc2VsZWN0b3JzLmRlbGV0ZU1vZGFsKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXG4gIHNlbGVjdG9ycy5wcm9maWxlVGl0bGUsXG4gIHNlbGVjdG9ycy5wcm9maWxlRGVzY3JpcHRpb24sXG4gIHNlbGVjdG9ycy5wcm9maWxlSW1hZ2Vcbik7XG5cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZWRpdFVzZXJNb2RhbCwgZGVmYXVsdEZvcm1Db25maWcpO1xuY29uc3QgY3JlYXRlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGFkZENhcmRNb2RhbCwgZGVmYXVsdEZvcm1Db25maWcpO1xuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGF2YXRhck1vZGFsLCBkZWZhdWx0Rm9ybUNvbmZpZyk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSwgdXNlcklkKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBkYXRhOiBkYXRhLFxuICAgICAgdXNlcklkOiB1c2VySWQsXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoKSA9PiB7XG4gICAgICAgIGltYWdlUG9wdXAub3BlbihkYXRhKTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVEZWxldGVDbGljazogKCkgPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGNhcmQuZ2V0Q2FyZElkKCk7XG4gICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLm9wZW5Nb2RhbCgpO1xuICAgICAgICBjb25maXJtYXRpb25Qb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgIGNvbmZpcm1hdGlvblBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICAgICAgYXBpXG4gICAgICAgICAgICAuZGVsZXRlQ2FyZEJ5SWQoaWQpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgICAgICAgICBjb25maXJtYXRpb25Qb3B1cC5jbG9zZU1vZGFsKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IGNvbmZpcm1hdGlvblBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuICAgICAgaGFuZGxlVXNlckxpa2VzOiAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGlkID0gY2FyZC5nZXRDYXJkSWQoKTtcbiAgICAgICAgY29uc3QgbGlrZXMgPSBjYXJkLmdldFVzZXJMaWtlc0NvdW50KCk7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5jaGFuZ2VDYXJkTGlrZVN0YXR1cyhpZCwgbGlrZXMpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiXG4gICk7XG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufVxuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZEZvcm1Nb2RhbC5vcGVuTW9kYWwoKTtcbn0pO1xuXG5jb25zdCBhZGRGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5hZGRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBhZGRGb3JtTW9kYWwucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkKGRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICBjcmVhdGVDYXJkKGRhdGEpO1xuICAgICAgICBjcmVhdGVNb2RhbEZvcm0ucmVzZXQoKTtcbiAgICAgICAgYWRkRm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4gYWRkRm9ybU1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcbiAgfSxcbn0pO1xuXG5hdmF0YXJJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhckZvcm1Nb2RhbC5vcGVuTW9kYWwoKTtcbn0pO1xuXG5jb25zdCBhdmF0YXJGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IHNlbGVjdG9ycy5hdmF0YXJNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGF2YXRhcikgPT4ge1xuICAgIGF2YXRhckZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgIGFwaVxuICAgICAgLnNldFVzZXJBdmF0YXIoYXZhdGFyKVxuICAgICAgLnRoZW4oKGF2YXRhcikgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRBdmF0YXIoYXZhdGFyKTtcbiAgICAgICAgYXZhdGFyRm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAgIC5maW5hbGx5KCgpID0+IGF2YXRhckZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XG4gIH0sXG59KTtcblxuY29uc3QgZmlsbFByb2ZpbGVGb3JtID0gKHsgbmFtZSwgcm9sZSB9KSA9PiB7XG4gIHByb2ZpbGVJbnB1dE5hbWUudmFsdWUgPSBuYW1lO1xuICBwcm9maWxlSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHJvbGU7XG59O1xuXG5lZGl0VXNlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIHJvbGUgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGZpbGxQcm9maWxlRm9ybSh7IG5hbWUsIHJvbGUgfSk7XG4gIGVkaXRGb3JtTW9kYWwub3Blbk1vZGFsKCk7XG59KTtcblxuY29uc3QgZWRpdEZvcm1Nb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmVkaXRNb2RhbCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICBlZGl0Rm9ybU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgYXBpXG4gICAgICAuZWRpdFVzZXJJbmZvKGRhdGEpXG4gICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXG4gICAgICAgIH0pO1xuICAgICAgICBlZGl0Rm9ybU1vZGFsLmNsb3NlTW9kYWwoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4gZWRpdEZvcm1Nb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XG4gIH0sXG59KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFt1c2VyLCBjYXJkc10pID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICBhYm91dDogdXNlci5hYm91dCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGF2YXRhciA9IHVzZXIuYXZhdGFyO1xuICAgIHVzZXJJbmZvLnNldEF2YXRhcihhdmF0YXIpO1xuXG4gICAgY29uc3QgdXNlcklkID0gdXNlci5faWQ7XG4gICAgY29uc3QgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGl0ZW1zOiBjYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSwgdXNlcklkKTtcbiAgICAgICAgICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkKTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBzZWxlY3RvcnMuY2FyZHNTZWN0aW9uXG4gICAgKTtcbiAgICBjYXJkc0xpc3QucmVuZGVySXRlbXMoKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gIH0pO1xuXG5hZGRGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmF2YXRhckZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuY29uZmlybWF0aW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5jcmVhdGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBhdXRoVG9rZW4sIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2F1dGhUb2tlbiA9IGF1dGhUb2tlbjtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIF9oYW5kbGVSZXNwb25zZShyZXNwb25zZSkge1xuICAgIHJldHVybiByZXNwb25zZS5va1xuICAgICAgPyByZXNwb25zZS5qc29uKClcbiAgICAgIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICB9XG5cbiAgX2hhbmRsZVJlc3BvbnNlRXJyb3IoZXJyKSB7XG4gICAgY29uc29sZS5sb2coYEVycm9yIHByb2Nlc3NpbmcgcmVxdWVzdCAke2Vycn1gKTtcbiAgfVxuXG4gIC8vIEdFVDogR2V0IEFwcCBEYXRhIChjYXJkc0xpc3QsIHVzZXJEYXRhKVxuICBnZXRBcHBJbmZvKCkge1xuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XG4gIH1cblxuICAvLyBHRVQ6IExpc3Qgb2YgY2FyZHNcbiAgZ2V0SW5pdGlhbENhcmRzID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG5cbiAgLy8gUE9TVDogQWRkIG5ldyBjYXJkXG4gIGFkZENhcmQgPSBhc3luYyAoeyBuYW1lLCBsaW5rIH0pID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzcG9uc2UpO1xuICB9O1xuXG4gIC8vIERFTEVURTogRGVsZXRlIGNhcmRcbiAgZGVsZXRlQ2FyZEJ5SWQgPSBhc3luYyAoaWQpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaWQsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faGFuZGxlUmVzcG9uc2UocmVzcG9uc2UpO1xuICB9O1xuXG4gIC8vIEdFVDogR2V0cyBVc2VyIFByb2ZpbGVcbiAgZ2V0VXNlckluZm8gPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgfTtcblxuICAvLyBQQVRDSDogRWRpdCBVc2VyIFByb2ZpbGVcbiAgZWRpdFVzZXJJbmZvID0gYXN5bmMgKHsgbmFtZSwgYWJvdXQgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGFib3V0LFxuICAgICAgfSksXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZVJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgfTtcblxuICAvLyBQQVRDSDogRWRpdCBQcm9maWxlIFBpY3R1cmVcbiAgc2V0VXNlckF2YXRhciA9IGFzeW5jICh7IGF2YXRhciB9KSA9PiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG5cbiAgLy8gUFVUIHwgREVMRVRFOiBBZGQgfCBSZW1vdmUgVXNlciBsaWtlc1xuICBjaGFuZ2VDYXJkTGlrZVN0YXR1cyA9IGFzeW5jIChjYXJkSWQsIGxpa2UpID0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogbGlrZSA/IFwiUFVUXCIgOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbGlrZSxcbiAgICAgIH0pLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVSZXNwb25zZShyZXNwb25zZSk7XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3BXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLW1vZGFsXCIpO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9pbWFnZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkRGVzY3JpcHRpb24gPSB0aGlzLl9pbWFnZUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxuICAgIGNhcmRJbWFnZS5zcmMgPSBsaW5rO1xuICAgIGNhcmRJbWFnZS5hbHQgPSBuYW1lO1xuICAgIGNhcmREZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3Blbk1vZGFsKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wV2l0aEltYWdlO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIlxuICAgICk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJZZXNcIjtcbiAgICB9XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oaGFuZGxlU3VibWl0KSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVTdWJtaXQpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19idXR0b24tZGlzYWJsZWRcIik7XG4gIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhDb25maXJtYXRpb247XG4iLCJjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3RvciwgZGVzY3JpcHRpb25TZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIHJvbGU6IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldEF2YXRhcihhdmF0YXIpIHtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2VySW5mbztcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IGRhdGEsIHVzZXJJZCwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZVVzZXJMaWtlcyB9LFxuICAgIGNhcmRTZWxlY3RvclxuICApIHtcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVVc2VyTGlrZXMgPSBoYW5kbGVVc2VyTGlrZXM7XG4gIH1cblxuICBnZXRDYXJkSWQgPSAoKSA9PiB0aGlzLl9pZDtcbiAgZ2V0VXNlckxpa2VzQ291bnQoKSB7XG4gICAgaWYgKHRoaXMuX2xpa2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgfVxuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZFRlbXBsYXRlO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIC8vIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgaGFuZGxlTGlrZUljb24gPSAoKSA9PiB7XG4gICAgdGhpcy5fZWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1hY3RpdmVcIik7XG4gIH07XG5cbiAgc2V0TGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIC8vIHJldHVybiB0cnVlIGlmIHVzZXIgbGlrZWQgdGhlIGNhcmQsIG90aGVyd2lzZSBmYWxzZVxuICB9XG5cbiAgcmVuZGVyTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICAvLyBhZGQgYWN0aXZlIGNsYXNzIHRvIGxpa2VzIGJ1dHRvblxuICAgICAgLy8gdGhlIGVsZW1lbnQgY2FuIGJlIHJlZmFjdG9yZWRcbiAgICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWFjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gcmVtb3ZlIGFjdGl2ZSBjbGFzcyB0byBsaWtlIGJ1dHRvblxuICAgICAgdGhpcy5fZWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKCkpO1xuXG4gICAgdGhpcy5fZWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlVXNlckxpa2VzKCkpO1xuXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXG4gICAgICAgIHNyYzogdGhpcy5fbGluayxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnRUZXh0ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xhYmVsLXRleHRcIik7XG4gICAgY29uc3QgaW1hZ2VMaWtlcyA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50XCIpO1xuXG4gICAgaW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgaW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX25hbWU7XG4gICAgaW1hZ2VFbGVtZW50VGV4dC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgaW1hZ2VMaWtlcy50ZXh0Q29udGVudCA9IHRoaXMuZ2V0VXNlckxpa2VzQ291bnQoKTtcblxuICAgIGlmICh0aGlzLl91c2VySWQgPT0gdGhpcy5fb3duZXJJZCkge1xuICAgICAgdGhpcy5oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTZWN0aW9uO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJzZXR0aW5ncyIsImlucHV0IiwiZXJyb3JFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwidGhpcyIsIl9zZXR0aW5ncyIsImVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJyZW1vdmUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiX2Zvcm1FbGVtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJldmVyeSIsIl9jaGVja0Zvcm1WYWxpZGl0eSIsIl9idXR0b25FbGVtZW50IiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInN1Ym1pdEJ1dHRvblNlbGV0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiZm9ybVNlbGVjdG9yIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImlucHV0cyIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInNldFRpbWVvdXQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwicG9wdXBTZWxlY3RvciIsImNsb3NlTW9kYWwiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuTW9kYWwiLCJfaGFuZGxlRXNjYXBlUG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cCIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfaW5wdXRzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJyZXNldCIsIkFVVEhfVE9LRU4iLCJIRUFERVJTIiwiYXV0aG9yaXphdGlvbiIsImRlZmF1bHRGb3JtQ29uZmlnIiwiY3JlYXRlTW9kYWxGb3JtIiwiYWRkQ2FyZEJ1dHRvbiIsImF2YXRhckljb24iLCJlZGl0VXNlckJ1dHRvbiIsInByb2ZpbGVJbnB1dE5hbWUiLCJwcm9maWxlSW5wdXREZXNjcmlwdGlvbiIsImFwaSIsImJhc2VVcmwiLCJhdXRoVG9rZW4iLCJoZWFkZXJzIiwiYXN5bmMiLCJyZXNwb25zZSIsImZldGNoIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9oYW5kbGVSZXNwb25zZSIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYXZhdGFyIiwiY2FyZElkIiwibGlrZSIsIl9hdXRoVG9rZW4iLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIl9oYW5kbGVSZXNwb25zZUVycm9yIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImdldEFwcEluZm8iLCJhbGwiLCJnZXRVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsImVkaXRVc2VyTW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJhdmF0YXJNb2RhbCIsImltYWdlUG9wdXAiLCJvcGVuIiwiX2ltYWdlRWxlbWVudCIsImNhcmRJbWFnZSIsImNhcmREZXNjcmlwdGlvbiIsInNyYyIsImFsdCIsImNvbmZpcm1hdGlvblBvcHVwIiwiX21vZGFsRWxlbWVudCIsIl9zdWJtaXRCdXR0b24iLCJzZXRTdWJtaXRBY3Rpb24iLCJoYW5kbGVTdWJtaXQiLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsInJvbGUiLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImNyZWF0ZUZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiY3JlYXRlQ2FyZCIsImRhdGEiLCJ1c2VySWQiLCJjYXJkIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlVXNlckxpa2VzIiwiX2lkIiwiX2VsZW1lbnQiLCJ0b2dnbGUiLCJfZGF0YSIsIl91c2VySWQiLCJfb3duZXJJZCIsIm93bmVyIiwiX25hbWUiLCJfbGluayIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZVVzZXJMaWtlcyIsImdldFVzZXJMaWtlc0NvdW50IiwibGVuZ3RoIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImhhbmRsZURlbGV0ZUNhcmQiLCJzZXRMaWtlcyIsIl9yZW5kZXJMaWtlcyIsImlzTGlrZWQiLCJyZW5kZXJMaWtlcyIsIl9zZXRFdmVudExpc3RlbmVycyIsImdlbmVyYXRlQ2FyZCIsImltYWdlRWxlbWVudCIsImltYWdlRWxlbWVudFRleHQiLCJpbWFnZUxpa2VzIiwiZ2V0Q2FyZElkIiwiZGVsZXRlQ2FyZEJ5SWQiLCJ0aGVuIiwiY2F0Y2giLCJlcnJvciIsImZpbmFsbHkiLCJjaGFuZ2VDYXJkTGlrZVN0YXR1cyIsImhhbmRsZUxpa2VJY29uIiwiYWRkRm9ybU1vZGFsIiwiUG9wdXBXaXRoRm9ybSIsImFkZENhcmQiLCJhdmF0YXJGb3JtTW9kYWwiLCJzZXRVc2VyQXZhdGFyIiwiZmlsbFByb2ZpbGVGb3JtIiwiZWRpdEZvcm1Nb2RhbCIsImVkaXRVc2VySW5mbyIsInVzZXIiLCJjYXJkcyIsImNhcmRzTGlzdCIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwicHJlcGVuZCJdLCJzb3VyY2VSb290IjoiIn0=